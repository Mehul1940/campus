{% extends 'core/base.html' %}
{% load static %}

{% block title %}My Profile - Campus Hub{% endblock %}

{% block content %}
<div class="bg-secondary bg-gradient py-5 mb-5 shadow-sm">
    <div class="container">
        <div class="row align-items-center text-center text-md-start g-4">
            <div class="col-md-auto">
                <div class="position-relative d-inline-block">
                    <img src="{{ user_profile.profile_image.url }}" alt="{{ user.get_full_name }}"
                        class="rounded-circle border border-4 border-white shadow-lg object-fit-cover"
                        style="width: 140px; height: 140px;">
                    <span
                        class="position-absolute bottom-0 end-0 bg-success border border-2 border-white rounded-circle p-2"
                        title="Online"></span>
                </div>
            </div>
            <div class="col-md text-white">
                <h1 class="display-4 fw-bold mb-1">{{ user.get_full_name }}</h1>
                <div class="d-flex flex-wrap justify-content-center justify-content-md-start gap-2">
                    <span class="badge bg-white text-primary px-3 py-2 fw-bold shadow-sm">
                        <i class="bi bi-patch-check-fill me-1"></i>{{ user_profile.get_role_display }}
                    </span>
                    <span
                        class="badge bg-white bg-opacity-25 text-white px-3 py-2 border border-white border-opacity-25">
                        <i class="bi bi-person-badge me-1"></i>{{ user.username }}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container pb-5">
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <div class="card border-0 shadow-sm rounded-4 mb-4 overflow-hidden">
                    <div class="card-header bg-white py-3 border-bottom border-light">
                        <h5 class="card-title mb-0 fw-bold text-primary">
                            <i class="bi bi-person-circle me-2"></i>Personal Information
                        </h5>
                    </div>
                    <div class="card-body p-4">
                        <div class="row g-4">
                            <div class="col-md-6">
                                <label for="first_name"
                                    class="form-label small fw-bold text-secondary text-uppercase">First Name</label>
                                <input type="text"
                                    class="form-control form-control-lg rounded-3 border-secondary border-opacity-25 shadow-none"
                                    id="first_name" name="first_name" value="{{ user.first_name }}" required>
                            </div>
                            <div class="col-md-6">
                                <label for="last_name"
                                    class="form-label small fw-bold text-secondary text-uppercase">Last Name</label>
                                <input type="text"
                                    class="form-control form-control-lg rounded-3 border-secondary border-opacity-25 shadow-none"
                                    id="last_name" name="last_name" value="{{ user.last_name }}" required>
                            </div>
                            <div class="col-md-6">
                                <label for="email" class="form-label small fw-bold text-secondary text-uppercase">Email
                                    Address</label>
                                <div class="input-group">
                                    <span
                                        class="input-group-text bg-light border-secondary border-opacity-25 text-muted"><i
                                            class="bi bi-envelope"></i></span>
                                    <input type="email"
                                        class="form-control form-control-lg rounded-end-3 border-secondary border-opacity-25 shadow-none"
                                        id="email" name="email" value="{{ user.email }}" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="phone" class="form-label small fw-bold text-secondary text-uppercase">Phone
                                    Number</label>
                                <div class="input-group">
                                    <span
                                        class="input-group-text bg-light border-secondary border-opacity-25 text-muted"><i
                                            class="bi bi-phone"></i></span>
                                    <input type="tel"
                                        class="form-control form-control-lg rounded-end-3 border-secondary border-opacity-25 shadow-none"
                                        id="phone" name="phone" value="{{ user_profile.phone }}">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card border-0 shadow-sm rounded-4 mb-4 overflow-hidden">
                    <div class="card-header bg-white py-3 border-bottom border-light">
                        <h5 class="card-title mb-0 fw-bold text-primary">
                            <i class="bi bi-mortarboard me-2"></i>Academic Details
                        </h5>
                    </div>
                    <div class="card-body p-4 text-dark">
                        <div class="row g-4 text-dark">
                            <div class="col-md-6">
                                <label for="roll_number"
                                    class="form-label small fw-bold text-secondary text-uppercase">Roll Number</label>
                                <input type="text"
                                    class="form-control form-control-lg rounded-3 border-secondary border-opacity-25 shadow-none"
                                    id="roll_number" name="roll_number" value="{{ user_profile.roll_number }}">
                            </div>
                            <div class="col-md-6 text-dark">
                                <label for="department"
                                    class="form-label small fw-bold text-secondary text-uppercase">Department</label>
                                <input type="text"
                                    class="form-control form-control-lg rounded-3 border-secondary border-opacity-25 shadow-none"
                                    id="department" name="department" value="{{ user_profile.department }}">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card border-0 shadow-sm rounded-4 mb-5 overflow-hidden">
                    <div class="card-header bg-white py-3 border-bottom border-light">
                        <h5 class="card-title mb-0 fw-bold text-primary">
                            <i class="bi bi-camera me-2"></i>Profile Media
                        </h5>
                    </div>
                    <div class="card-body p-4">
                        <div class="row align-items-center g-4">
                            <div class="col-md-auto">
                                <img src="{{ user_profile.profile_image.url }}" alt="Profile"
                                    class="rounded-4 border shadow-sm"
                                    style="width: 120px; height: 120px; object-fit: cover;">
                            </div>
                            <div class="col-md text-dark">
                                <label for="profile_image" class="form-label fw-bold">Change Profile Picture</label>
                                <input type="file"
                                    class="form-control rounded-pill border-secondary border-opacity-25 shadow-none"
                                    id="profile_image" name="profile_image" accept="image/*">
                                <div class="form-text mt-2"><i class="bi bi-info-circle me-1"></i>Recommended: Square
                                    JPG or PNG, max 5MB.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="d-flex flex-column flex-md-row gap-3">
                    <button type="submit" class="btn btn-primary btn-lg px-5 fw-bold shadow-sm order-md-2">
                        <i class="bi bi-check-lg me-1"></i> Save Changes
                    </button>
                    <a href="{% url 'core:dashboard' %}"
                        class="btn btn-light btn-lg px-5 border fw-bold text-secondary order-md-1">
                        <i class="bi bi-arrow-left me-1"></i> Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}